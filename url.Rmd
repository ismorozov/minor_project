---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}

library(RCurl)
library(XML)
library(plyr)
library(tm)
library(tau)
library(tidyr)
library(taRifx)
library(quanteda)
library(ggplot2)

# Сюда вставлять адрес страницы со списком (до &page=)
for (i in 1:12) {
  url <- paste("http://spb.rosrabota.ru/res?text=%D0%BE%D1%85%D1%80%D0%B0%D0%BD%D0%BD%D0%B8%D0%BA&page=", i)
  url <- gsub(" ", "", url, fixed = FALSE)
  html<-getURL(url)
  doc<-htmlParse(html)

  urls <- as.vector(unlist(xpathSApply(doc, "//h3/a", xmlGetAttr, "href")))

# Здесь создается таблица с данными вакансий
  info <- as.data.frame(urls)
  info$urls <- as.character(info$urls)

  for (k in 1:nrow(info)) {
    url1<-paste("http:", info$urls[k])
    url1 <- gsub(" ", "", url1, fixed = FALSE)
    html1<-getURL(url1)
    doc1<-htmlParse(html1)
    
    info$val[k] <- unlist(xpathSApply(doc1, "//dl[@class='params dl-horizontal w180']", xmlValue))
    
    Sys.sleep(60)
  }

# Сохранить файл

  saveRDS(info, file = paste("resumes_ohrana-", i, ".rds")) # ввести своё имя
  
  Sys.sleep(30)
}  
          
```

